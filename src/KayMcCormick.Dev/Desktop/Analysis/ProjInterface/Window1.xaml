<kmWpf:AppWindow x:Class="ProjInterface.Window1"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:local="clr-namespace:ProjInterface"
                 xmlns:kmWpf="http://kaymccormick.com/xaml/kmwpf"
                 xmlns:xcad="http://schemas.xceed.com/wpf/xaml/avalondock"
                 xmlns:io="clr-namespace:System.IO;assembly=mscorlib"
                 xmlns:collections="clr-namespace:System.Collections;assembly=mscorlib"
                 DataContext="{Binding RelativeSource={RelativeSource Self},Path=ViewModel}"
                 mc:Ignorable="d"
                 Title="Window1" Height="450" Width="800">
  <kmWpf:AppWindow.Resources>
    <Style x:Key="ToolBarButtonBaseStyle"
           TargetType="{x:Type ButtonBase}">
      <Setter Property="SnapsToDevicePixels"
              Value="true" />
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ButtonBase}">
            <Border x:Name="Border"
                    BorderThickness="1">
              <Border.BorderBrush>
                <LinearGradientBrush EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                  <GradientStop
                    Color="{DynamicResource BorderLightColor}"
                    Offset="0" />
                  <GradientStop
                    Color="{DynamicResource BorderMediumColor}"
                    Offset="1" />
                </LinearGradientBrush>
              </Border.BorderBrush>
              <Border.Background>
                <LinearGradientBrush EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                  <GradientStop
                    Color="{DynamicResource ControlLightColor}"
                    Offset="0" />
                  <GradientStop
                    Color="{DynamicResource ControlMediumColor}"
                    Offset="1" />
                </LinearGradientBrush>
              </Border.Background>
              <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                  <VisualState x:Name="Normal" />
                  <VisualState x:Name="Pressed">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource ControlPressedColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="MouseOver">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource ControlMouseOverColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="Disabled">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background). 
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource DisabledControlDarkColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                </VisualStateGroup>
                <VisualStateGroup x:Name="CheckStates">
                  <VisualState x:Name="Checked">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource ControlPressedColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="Unchecked" />
                  <VisualState x:Name="Indeterminate" />
                </VisualStateGroup>
              </VisualStateManager.VisualStateGroups>
              <ContentPresenter Margin="2"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                RecognizesAccessKey="True" />
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="{x:Static ToolBar.ButtonStyleKey}"
           BasedOn="{StaticResource ToolBarButtonBaseStyle}"
           TargetType="{x:Type Button}" />
    <Style x:Key="{x:Static ToolBar.ToggleButtonStyleKey}"
           BasedOn="{StaticResource ToolBarButtonBaseStyle}"
           TargetType="{x:Type ToggleButton}" />
    <Style x:Key="{x:Static ToolBar.CheckBoxStyleKey}"
           BasedOn="{StaticResource ToolBarButtonBaseStyle}"
           TargetType="{x:Type CheckBox}" />
    <Style x:Key="{x:Static ToolBar.RadioButtonStyleKey}"
           BasedOn="{StaticResource ToolBarButtonBaseStyle}"
           TargetType="{x:Type RadioButton}" />

    <Style x:Key="{x:Static ToolBar.TextBoxStyleKey}"
           TargetType="{x:Type TextBox}">
      <Setter Property="SnapsToDevicePixels"
              Value="True" />
      <Setter Property="OverridesDefaultStyle"
              Value="True" />
      <Setter Property="KeyboardNavigation.TabNavigation"
              Value="None" />
      <Setter Property="FocusVisualStyle"
              Value="{x:Null}" />
      <Setter Property="AllowDrop"
              Value="true" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type TextBox}">
            <Border x:Name="Border"
                    Padding="2"
                    BorderThickness="1">
              <Border.Background>
                <SolidColorBrush
                  Color="{DynamicResource ControlLightColor}" />
              </Border.Background>
              <Border.BorderBrush>
                <SolidColorBrush
                  Color="{StaticResource BorderMediumColor}" />
              </Border.BorderBrush>
              <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                  <VisualState x:Name="Normal" />
                  <VisualState x:Name="Disabled">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).  
                    (SolidColorBrush.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource DisabledControlDarkColor}" />
                      </ColorAnimationUsingKeyFrames>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Border.BorderBrush).  
                    (SolidColorBrush.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource DisabledBorderLightColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="ReadOnly" />
                  <VisualState x:Name="MouseOver" />
                </VisualStateGroup>
              </VisualStateManager.VisualStateGroups>
              <ScrollViewer Margin="0"
                            x:Name="PART_ContentHost" />
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarThumbStyle"
           TargetType="{x:Type Thumb}">
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="Cursor"
              Value="SizeAll" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Thumb}">
            <Border Background="Transparent"
                    SnapsToDevicePixels="True">
              <Rectangle Margin="0,2">
                <Rectangle.Fill>
                  <DrawingBrush Viewport="0,0,4,4"
                                ViewportUnits="Absolute"
                                Viewbox="0,0,8,8"
                                ViewboxUnits="Absolute"
                                TileMode="Tile">
                    <DrawingBrush.Drawing>
                      <DrawingGroup>
                        <GeometryDrawing Brush="#AAA"
                                         Geometry="M 4 4 L 4 8 L 8 8 L 8 4 z" />
                      </DrawingGroup>
                    </DrawingBrush.Drawing>
                  </DrawingBrush>
                </Rectangle.Fill>
              </Rectangle>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ToolBarOverflowButtonStyle"
           TargetType="{x:Type ToggleButton}">
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate
            TargetType="{x:Type ToggleButton}">
            <Border x:Name="Border"
                    CornerRadius="0,3,3,0"
                    SnapsToDevicePixels="true">
              <Border.Background>
                <LinearGradientBrush EndPoint="0.5,1"
                                     StartPoint="0.5,0">
                  <GradientStop Color="#00000000"
                                Offset="0" />
                  <GradientStop Offset="1" />
                </LinearGradientBrush>
              </Border.Background>
              <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                  <VisualState x:Name="Normal" />
                  <VisualState x:Name="Pressed">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).    
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource ControlPressedColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="MouseOver">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).     
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource ControlMouseOverColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="Disabled">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).   
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource DisabledBorderLightColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                </VisualStateGroup>
              </VisualStateManager.VisualStateGroups>
              <Grid>
                <Path x:Name="Arrow"
                      Fill="Black"
                      VerticalAlignment="Bottom"
                      Margin="2,3"
                      Data="M -0.5 3 L 5.5 3 L 2.5 6 Z" />
                <ContentPresenter />
              </Grid>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="{x:Type ToolBar}"
           TargetType="{x:Type ToolBar}">
      <Setter Property="SnapsToDevicePixels"
              Value="true" />
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type ToolBar}">
            <Border x:Name="Border"
                    CornerRadius="2"
                    BorderThickness="1">
              <Border.BorderBrush>
                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="0,1">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource BorderMediumColor}"
                        Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource BorderDarkColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>
              </Border.BorderBrush>

              <Border.Background>
                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="0,1">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop Color="#FFF"
                                    Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource ControlMediumColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>
              </Border.Background>
              <DockPanel>
                <ToggleButton DockPanel.Dock="Right"
                              IsEnabled="{TemplateBinding HasOverflowItems}"
                              Style="{StaticResource ToolBarOverflowButtonStyle}"
                              ClickMode="Press"
                              IsChecked="{Binding IsOverflowOpen, Mode=TwoWay, 
              RelativeSource={RelativeSource TemplatedParent}}">
                  <Popup x:Name="OverflowPopup"
                         AllowsTransparency="true"
                         Placement="Bottom"
                         StaysOpen="false"
                         Focusable="false"
                         PopupAnimation="Slide"
                         IsOpen="{Binding IsOverflowOpen, 
                RelativeSource={RelativeSource TemplatedParent}}">
                    <Border x:Name="DropDownBorder"
                            BorderThickness="1">
                      <Border.BorderBrush>
                        <SolidColorBrush
                          Color="{DynamicResource BorderMediumColor}" />
                      </Border.BorderBrush>
                      <Border.Background>
                        <LinearGradientBrush
                          EndPoint="0.5,1"
                          StartPoint="0.5,0">
                          <GradientStop
                            Color="{DynamicResource ControlLightColor}" />
                          <GradientStop
                            Color="{DynamicResource ControlMediumColor}"
                            Offset="1" />
                        </LinearGradientBrush>
                      </Border.Background>
                      <ToolBarOverflowPanel
                        x:Name="PART_ToolBarOverflowPanel"
                        Margin="2"
                        WrapWidth="200"
                        Focusable="true"
                        FocusVisualStyle="{x:Null}"
                        KeyboardNavigation.TabNavigation="Cycle"
                        KeyboardNavigation.DirectionalNavigation="Cycle" />
                    </Border>
                  </Popup>
                </ToggleButton>

                <Thumb x:Name="ToolBarThumb"
                       Style="{StaticResource ToolBarThumbStyle}"
                       Width="10" />
                <ToolBarPanel x:Name="PART_ToolBarPanel"
                              IsItemsHost="true"
                              Margin="0,1,2,2" />
              </DockPanel>
            </Border>
            <ControlTemplate.Triggers>
              <Trigger Property="IsOverflowOpen"
                       Value="true">
                <Setter TargetName="ToolBarThumb"
                        Property="IsEnabled"
                        Value="false" />
              </Trigger>
              <Trigger Property="ToolBarTray.IsLocked"
                       Value="true">
                <Setter TargetName="ToolBarThumb"
                        Property="Visibility"
                        Value="Collapsed" />
              </Trigger>
            </ControlTemplate.Triggers>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="{x:Type ToolBarTray}"
           TargetType="{x:Type ToolBarTray}">
      <Setter Property="Background">
        <Setter.Value>
          <LinearGradientBrush StartPoint="0,0"
                               EndPoint="1,0">
            <LinearGradientBrush.GradientStops>
              <GradientStopCollection>
                <GradientStop Color="#FFF"
                              Offset="0.0" />
                <GradientStop
                  Color="{DynamicResource WindowColor}"
                  Offset="1.0" />
              </GradientStopCollection>
            </LinearGradientBrush.GradientStops>
          </LinearGradientBrush>
        </Setter.Value>
      </Setter>
    </Style>
    <BitmapImage UriSource="Assets/shell32_329.ico"
                 x:Key="PowerOffImage" />
    <collections:Hashtable x:Key="IconsResources">
      <BitmapImage UriSource="Assets/imageres_162.ico"
                   x:Key="{x:Type io:Directory}" />
      <BitmapImage UriSource="Assets/Blend_6826.ico"
                   x:Key=".sln" />
    </collections:Hashtable>
    <ContextMenu x:Key="itemContextMenu">
      <MenuItem Header="Delete"
                IsEnabled="{Binding CanDelete}" />
      <MenuItem Header="Rename"
                IsEnabled="{Binding CanRename}" />
    </ContextMenu>
    <ContextMenu x:Key="listContextMenu">
      <MenuItem Header="New Folder"
                IsEnabled="{Binding CanCreateFolder}" />
      <MenuItem Header="New Link"
                IsEnabled="{Binding CanCreateLink}" />
    </ContextMenu>
    <kmWpf:GetTypeConverter x:Key="GetTypeConverter" />
    <local:DictionaryConverter x:Key="DictionaryConverter" />
    <DataTemplate x:Key="Template1">
      <TextBlock
        Text="{Binding Metadata,Mode=OneWay,Converter={StaticResource DictionaryConverter},ConverterParameter=Title}" />
    </DataTemplate>
    <Style x:Key="ScrollBarLineButton"
           TargetType="{x:Type RepeatButton}">
      <Setter Property="SnapsToDevicePixels"
              Value="True" />
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="Focusable"
              Value="false" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate
            TargetType="{x:Type RepeatButton}">
            <Border x:Name="Border"
                    Margin="1"
                    CornerRadius="2"
                    BorderThickness="1">
              <Border.BorderBrush>
                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="0,1">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource BorderMediumColor}"
                        Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource BorderDarkColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>
              </Border.BorderBrush>
              <Border.Background>
                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="0,1">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource ControlLightColor}" />
                      <GradientStop
                        Color="{DynamicResource ControlMediumColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>
              </Border.Background>
              <VisualStateManager.VisualStateGroups>
                <VisualStateGroup x:Name="CommonStates">
                  <VisualState x:Name="Normal" />
                  <VisualState x:Name="MouseOver" />
                  <VisualState x:Name="Pressed">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Border"
                        Storyboard.TargetProperty="(Panel.Background).
                    (GradientBrush.GradientStops)[1].(GradientStop.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource ControlPressedColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                  <VisualState x:Name="Disabled">
                    <Storyboard>
                      <ColorAnimationUsingKeyFrames
                        Storyboard.TargetName="Arrow"
                        Storyboard.TargetProperty="(Shape.Fill).
                    (SolidColorBrush.Color)">
                        <EasingColorKeyFrame KeyTime="0"
                                             Value="{StaticResource DisabledForegroundColor}" />
                      </ColorAnimationUsingKeyFrames>
                    </Storyboard>
                  </VisualState>
                </VisualStateGroup>
              </VisualStateManager.VisualStateGroups>
              <Path x:Name="Arrow"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Data="{Binding Content, 
            RelativeSource={RelativeSource TemplatedParent}}">
                <Path.Fill>
                  <SolidColorBrush
                    Color="{DynamicResource GlyphColor}" />
                </Path.Fill>
              </Path>
            </Border>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ScrollBarPageButton"
           TargetType="{x:Type RepeatButton}">
      <Setter Property="SnapsToDevicePixels"
              Value="True" />
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="IsTabStop"
              Value="false" />
      <Setter Property="Focusable"
              Value="false" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate
            TargetType="{x:Type RepeatButton}">
            <Border Background="Transparent" />
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <Style x:Key="ScrollBarThumb"
           TargetType="{x:Type Thumb}">
      <Setter Property="SnapsToDevicePixels"
              Value="True" />
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Setter Property="IsTabStop"
              Value="false" />
      <Setter Property="Focusable"
              Value="false" />
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="{x:Type Thumb}">
            <Border CornerRadius="2"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="1" />
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>

    <ControlTemplate x:Key="VerticalScrollBar"
                     TargetType="{x:Type ScrollBar}">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition MaxHeight="18" />
          <RowDefinition Height="0.00001*" />
          <RowDefinition MaxHeight="18" />
        </Grid.RowDefinitions>
        <Border Grid.RowSpan="3"
                CornerRadius="2"
                Background="#F0F0F0" />
        <RepeatButton Grid.Row="0"
                      Style="{StaticResource ScrollBarLineButton}"
                      Height="18"
                      Command="ScrollBar.LineUpCommand"
                      Content="M 0 4 L 8 4 L 4 0 Z" />
        <Track x:Name="PART_Track"
               Grid.Row="1"
               IsDirectionReversed="true">
          <Track.DecreaseRepeatButton>
            <RepeatButton
              Style="{StaticResource ScrollBarPageButton}"
              Command="ScrollBar.PageUpCommand" />
          </Track.DecreaseRepeatButton>
          <Track.Thumb>
            <Thumb Style="{StaticResource ScrollBarThumb}"
                   Margin="1,0,1,0">
              <Thumb.BorderBrush>

                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="1,0">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource BorderLightColor}"
                        Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource BorderDarkColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>

              </Thumb.BorderBrush>
              <Thumb.Background>

                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="1,0">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource ControlLightColor}"
                        Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource ControlMediumColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>

              </Thumb.Background>
            </Thumb>
          </Track.Thumb>
          <Track.IncreaseRepeatButton>
            <RepeatButton
              Style="{StaticResource ScrollBarPageButton}"
              Command="ScrollBar.PageDownCommand" />
          </Track.IncreaseRepeatButton>
        </Track>
        <RepeatButton Grid.Row="2"
                      Style="{StaticResource ScrollBarLineButton}"
                      Height="18"
                      Command="ScrollBar.LineDownCommand"
                      Content="M 0 0 L 4 4 L 8 0 Z" />
      </Grid>
    </ControlTemplate>

    <ControlTemplate x:Key="HorizontalScrollBar"
                     TargetType="{x:Type ScrollBar}">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition MaxWidth="18" />
          <ColumnDefinition Width="0.00001*" />
          <ColumnDefinition MaxWidth="18" />
        </Grid.ColumnDefinitions>
        <Border Grid.ColumnSpan="3"
                CornerRadius="2"
                Background="#F0F0F0" />
        <RepeatButton Grid.Column="0"
                      Style="{StaticResource ScrollBarLineButton}"
                      Width="18"
                      Command="ScrollBar.LineLeftCommand"
                      Content="M 4 0 L 4 8 L 0 4 Z" />
        <Track x:Name="PART_Track"
               Grid.Column="1"
               IsDirectionReversed="False">
          <Track.DecreaseRepeatButton>
            <RepeatButton
              Style="{StaticResource ScrollBarPageButton}"
              Command="ScrollBar.PageLeftCommand" />
          </Track.DecreaseRepeatButton>
          <Track.Thumb>
            <Thumb Style="{StaticResource ScrollBarThumb}"
                   Margin="0,1,0,1">

              <Thumb.BorderBrush>

                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="1,0">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource BorderLightColor}"
                        Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource BorderDarkColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>

              </Thumb.BorderBrush>
              <Thumb.Background>

                <LinearGradientBrush StartPoint="0,0"
                                     EndPoint="0,1">
                  <LinearGradientBrush.GradientStops>
                    <GradientStopCollection>
                      <GradientStop
                        Color="{DynamicResource ControlLightColor}"
                        Offset="0.0" />
                      <GradientStop
                        Color="{DynamicResource ControlMediumColor}"
                        Offset="1.0" />
                    </GradientStopCollection>
                  </LinearGradientBrush.GradientStops>
                </LinearGradientBrush>

              </Thumb.Background>
            </Thumb>
          </Track.Thumb>
          <Track.IncreaseRepeatButton>
            <RepeatButton
              Style="{StaticResource ScrollBarPageButton}"
              Command="ScrollBar.PageRightCommand" />
          </Track.IncreaseRepeatButton>
        </Track>
        <RepeatButton Grid.Column="2"
                      Style="{StaticResource ScrollBarLineButton}"
                      Width="18"
                      Command="ScrollBar.LineRightCommand"
                      Content="M 0 0 L 4 4 L 0 8 Z" />
      </Grid>
    </ControlTemplate>

    <Style x:Key="{x:Type ScrollBar}"
           TargetType="{x:Type ScrollBar}">
      <Setter Property="SnapsToDevicePixels"
              Value="True" />
      <Setter Property="OverridesDefaultStyle"
              Value="true" />
      <Style.Triggers>
        <Trigger Property="Orientation"
                 Value="Horizontal">
          <Setter Property="Width"
                  Value="Auto" />
          <Setter Property="Height"
                  Value="18" />
          <Setter Property="Template"
                  Value="{StaticResource HorizontalScrollBar}" />
        </Trigger>
        <Trigger Property="Orientation"
                 Value="Vertical">
          <Setter Property="Width"
                  Value="18" />
          <Setter Property="Height"
                  Value="Auto" />
          <Setter Property="Template"
                  Value="{StaticResource VerticalScrollBar}" />
        </Trigger>
      </Style.Triggers>
    </Style>
  </kmWpf:AppWindow.Resources>
  <kmWpf:AppWindow.CommandBindings>
    <CommandBinding Command="Open"
                    Executed="CommandBinding_OnExecuted" />
  </kmWpf:AppWindow.CommandBindings>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Menu Grid.Row="0" Grid.Column="0" FontSize="18.0">
      <MenuItem Header="File">
        <MenuItem Header="_Open" Command="Open" />
        <MenuItem Header="_Quit"
                  Command="kmWpf:WpfAppCommands.QuitApplication" />
      </MenuItem>
    </Menu>
    <ToolBarTray Grid.Row="1" Grid.Column="0">
      <ToolBar Band="1" BandIndex="1">
        <Button Padding="0"
                Command="kmWpf:WpfAppCommands.QuitApplication">
          <Image Source="{StaticResource PowerOffImage}" />
        </Button>
      </ToolBar>
    </ToolBarTray>
    <xcad:DockingManager Grid.Row="2" Grid.Column="0"
                         AllowMixedOrientation="True">
      <xcad:DockingManager.DocumentHeaderTemplate>
        <DataTemplate
          DataType="{x:Type xcad:LayoutDocument}">
          <StackPanel Orientation="Horizontal">
            <Image Source="{Binding IconSource}"
                   Margin="0,0,4,0" />
            <TextBlock Text="{Binding Title}" />
          </StackPanel>
        </DataTemplate>
      </xcad:DockingManager.DocumentHeaderTemplate>
      <xcad:LayoutRoot>
        <xcad:LayoutPanel Orientation="Horizontal">
          <xcad:LayoutAnchorablePane DockWidth="300">
            <xcad:LayoutAnchorable Title="Files"
                                   IconSource="Assets/imageres_162.ico"
                                   ContentId="fileBrowser">
              <Grid>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto" />
                  <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <TextBox Grid.Row="0" x:Name="pathTextBox"
                         Margin="3"
                         Text="{Binding ElementName=explorer, Path=SelectedPath, Mode=TwoWay, UpdateSourceTrigger=Explicit}"
                         local:InputBindingsManager.UpdatePropertySourceWhenEnterPressed="TextBox.Text" />
                <Explorer
                  ItemsSource="{Binding RootCollection}"
                  Grid.Row="1" x:Name="explorer"
                  Margin="3,0,3,0"
                  ItemContextMenu="{StaticResource itemContextMenu}"
                  ListContextMenu="{StaticResource listContextMenu}" />
              </Grid>
            </xcad:LayoutAnchorable>
          </xcad:LayoutAnchorablePane>
          <xcad:LayoutDocumentPaneGroup>
            <xcad:LayoutDocumentPane x:Name="docpane">
              <xcad:LayoutDocument Title="ConEmu Shell">
                <local:Shell />
              </xcad:LayoutDocument>
            </xcad:LayoutDocumentPane>
          </xcad:LayoutDocumentPaneGroup>
        </xcad:LayoutPanel>
        <xcad:LayoutRoot.LeftSide>
          <xcad:LayoutAnchorSide>
            <xcad:LayoutAnchorGroup>
              <xcad:LayoutAnchorable Title="Components">
                <ListBox Name="viewList"
                         ItemsSource="{Binding Path=Views}"
                         ItemTemplate="{StaticResource Template1}">
                  <ListBox.InputBindings>
                    <KeyBinding Key="Enter" Command="Open"
                                CommandParameter="{Binding ElementName=viewList,Path=SelectedItem}" />
                  </ListBox.InputBindings>
                </ListBox>
              </xcad:LayoutAnchorable>
            </xcad:LayoutAnchorGroup>
          </xcad:LayoutAnchorSide>
        </xcad:LayoutRoot.LeftSide>
      </xcad:LayoutRoot>
    </xcad:DockingManager>
    <StatusBar Grid.Row="3" Grid.Column="0">
      <StatusBarItem Content="Ready" />
    </StatusBar>
  </Grid>
</kmWpf:AppWindow>