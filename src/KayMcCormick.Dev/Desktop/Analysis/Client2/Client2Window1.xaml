<RibbonWindow x:Class="Client2.Client2Window1"
              xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
              xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
              xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
              xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
              xmlns:local="clr-namespace:Client2"
              xmlns:anal="http://kaymccormick.com/xaml/analysis"
              xmlns:kmWpf="http://kaymccormick.com/xaml/kmwpf"
              xmlns:primitives="clr-namespace:System.Windows.Controls.Ribbon.Primitives;assembly=System.Windows.Controls.Ribbon"
              xmlns:ribbon="clr-namespace:AnalysisControls.RibbonModel;assembly=AnalysisControls"
              xmlns:ribbon1="clr-namespace:System.Windows.Controls.Ribbon;assembly=System.Windows.Controls.Ribbon"
              xmlns:avalondock="https://github.com/Dirkster99/AvalonDock"
              xmlns:contextualTabGroups="clr-namespace:AnalysisControls.RibbonModel.ContextualTabGroups;assembly=AnalysisControls"
              xmlns:definition="clr-namespace:AnalysisControls.RibbonModel.Definition;assembly=AnalysisControls"
              xmlns:aal="clr-namespace:AnalysisAppLib;assembly=AnalysisAppLib"
              xmlns:system="clr-namespace:System;assembly=mscorlib"
              xmlns:viewModel="clr-namespace:AnalysisControls.ViewModel;assembly=AnalysisControls"
              xmlns:io="clr-namespace:System.IO;assembly=mscorlib"
              mc:Ignorable="d"
              Background="Blue"
              Loaded="Client2Window1_OnLoaded"
              DataContext="{Binding RelativeSource={RelativeSource Self}}"
              Title="Client2Window1" Height="900" Width="1600">
  <RibbonWindow.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary
          Source="Client2Global.xaml" />

        <ResourceDictionary
          Source="pack://application:,,,/AnalysisControls;component/RibbonModel.xaml" />
        <ResourceDictionary
          Source="pack://application:,,,/AnalysisControls;component/AppRibbonResources.xaml" />

        <ResourceDictionary

          Source="pack://application:,,,/WpfLib;component/SharedResources.xaml" />
        <ResourceDictionary
          Source="pack://application:,,,/WpfLib;component/ResourcesMisc.xaml" />
        <ResourceDictionary
          Source="pack://application:,,,/AnalysisControls;component/Templates.xaml" />
        <ResourceDictionary>
         <anal:ConvertButton x:Key="ConvertButton"/>
        </ResourceDictionary>
      </ResourceDictionary.MergedDictionaries>
      <local:TabItemTemplateSelector x:Key="TabItemTemplateSelector" />
      <CollectionViewSource Source="{Binding ViewModel.PrimaryRibbon.QuickAccessToolBar.Items}" x:Key="QATView" />
    </ResourceDictionary>
  </RibbonWindow.Resources>
  <RibbonWindow.CommandBindings>
    <CommandBinding Command="Paste" CanExecute="CanExecutePaste" Executed="OnExecutedPaste" />
    <CommandBinding Command="kmWpf:WpfAppCommands.CustomizeQAT" Executed="CustomizeQATExecuted" />
  </RibbonWindow.CommandBindings>
  <RibbonWindow.InputBindings>
    <KeyBinding Command="Paste" Key="V" Modifiers="Control" />
  </RibbonWindow.InputBindings>
  <Grid>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="*" />
      <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>
    <Grid.RenderTransform>
      <ScaleTransform ScaleX="2" ScaleY="2" />
    </Grid.RenderTransform>
    <anal:MyGrid>
      <anal:MyGrid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
      </anal:MyGrid.RowDefinitions>
      <anal:MyRibbon x:Name="myRibbon"
                     DataContext="{Binding ViewModel.PrimaryRibbon}"
                     Background="{Binding Background}"
                     SelectedItem="{Binding SelectedItem,Mode=TwoWay}"
                     ContextualTabGroupsSource="{Binding ContextualTabGroups}"
                     ItemTemplateSelector="{StaticResource TabItemTemplateSelector}"
                     
                     ItemsSource="{Binding RibbonItems}"
                     TabHeaderStyle="{StaticResource AppRibbonTabHeaderStyle}"
                     TabHeaderTemplate="{StaticResource AppRibbonModelTabTemplate}"
                     ContextualTabGroupHeaderTemplate="{StaticResource AppContextualTabGroupHeaderTemplate}"
                     ItemContainerStyle="{StaticResource AppMyRibbonItemContainerStyle}"
                     BorderBrush="{Binding BorderBrush}"
                     ItemsPanel="{StaticResource AppMyRibbonItemsPanelTemplate}" HelpPaneContent="{Binding HelpPaneContent}">
        <anal:MyRibbon.Resources>
          <anal:DirectoryInfoConverter x:Key="DirectoryInfoConverter"/>
          <DataTemplate DataType="{x:Type io:FileInfo}">
<anal:MyRibbonMenuItem Header="{Binding Name}"></anal:MyRibbonMenuItem>
          </DataTemplate>
          <DataTemplate DataType="{x:Type io:DirectoryInfo}">
            <anal:MyRibbonMenuItem Header="{Binding Name}"  ItemContainerTemplateSelector="{StaticResource ComboBoxTemplateSelector}"
                                      UsesItemContainerTemplate="True"
                                      ItemsSource="{Binding Converter={StaticResource DirectoryInfoConverter}}">
            </anal:MyRibbonMenuItem>
          </DataTemplate>
        </anal:MyRibbon.Resources>
        <anal:MyRibbon.QuickAccessToolBar>
          <anal:MyRibbonQuickAccessToolBar  x:Name="QAT"  DataContext="{Binding Path=QuickAccessToolBar}"  ItemsSource="{Binding Items}" CustomizeMenuButton="{Binding CustomizeMenuButton,Converter={StaticResource ConvertButton}}"/>
        </anal:MyRibbon.QuickAccessToolBar>
        <anal:MyRibbon.ApplicationMenu>
          <RibbonApplicationMenu x:Name="_AppMenu" ItemsSource="{Binding AppMenu.Items}" FooterPaneContent="{Binding AppMenu.FooterPaneContent}"/>
        </anal:MyRibbon.ApplicationMenu>
      </anal:MyRibbon>
        <anal:Main1 VerticalAlignment="Stretch" Grid.Row="1" Grid.Column="0" x:Name="Main1"   ViewModel="{kmWpf:Resolve viewModel:Main1Model}"  ViewModel2="{kmWpf:Resolve viewModel:Main1Mode2}"/>
        </anal:MyGrid>


  </Grid>

</RibbonWindow>